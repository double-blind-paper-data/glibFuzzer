{"id": 95005, "crash_type": "Heap-buffer-overflow READ {*}", "crash_address": "0x62b000006d80", "crash_state": "jxl::ModularFrameDecoder::DecodeGroup\njxl::FrameDecoder::ProcessACGroup\njxl::ThreadPool::RunCallState<jxl::FrameDecoder::ProcessSections\n", "crash_state_lines": ["jxl::ModularFrameDecoder::DecodeGroup", "jxl::FrameDecoder::ProcessACGroup", "jxl::ThreadPool::RunCallState<jxl::FrameDecoder::ProcessSections"], "crash_revision": 1, "csrf_token": "BJmTj3TnOivebelaZxzyGN0U2aUwzpr0PcnMYuCDcZGXbO4oHOOQJoWv0FDvXXNL0RwbAYQebtSf/lRw6DHrLg==", "external_user": false, "footer": "[2021-12-02 14:32:51 UTC] comput15-20211129-15:14: Fuzz task : Fuzzer libFuzzer_pngsave_buffer_fuzzer generated testcase crashed in 693 seconds (r1).\n[2021-12-02 14:58:08 UTC] snode9-20211129-17:29: Minimize task started.\n[2021-12-02 15:26:25 UTC] snode9-20211129-17:29: Minimize task finished.\n", "formatted_reproduction_help": "", "fixed": "NO", "fixed_full": null, "issue_url": null, "is_admin": true, "metadata": {"build_key": "f6591c65-0eac-4d5c-a59f-6ebe3515c9e3", "env": {"ASAN_OPTIONS": {}}, "fuzzer_binary_name": "pngsave_buffer_fuzzer", "fuzzing_strategies": {"corpus_mutations_radamsa": 1, "corpus_subset": 125, "value_profile": 1}}, "minimized_testcase_size": "1 KB", "needs_refresh": false, "original_testcase_size": "2 KB", "privileged_user": true, "regression": "NA", "crash_stacktrace": {"lines": [{"lineNumber": 1, "content": "[Environment] ASAN_OPTIONS=exitcode=77", "important": false, "type": "Line"}, {"lineNumber": 2, "content": "+----------------------------------------Release Build Stacktrace----------------------------------------+", "important": false, "type": "Line"}, {"lineNumber": 3, "content": "Command: /clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer -rss_limit_mb=2560 -timeout=60 -runs=100 /clusterfuzz/run_bot/clusterfuzz/bot/inputs/fuzzer-testcases/bc4530b26dddee45f320a14b4e30f2218a3ec3f6285f0d5b7b0078d2429910f9", "important": false, "type": "Line"}, {"lineNumber": 4, "content": "Time ran: 0.07726836204528809", "important": false, "type": "Line"}, {"lineNumber": 5, "content": "", "important": false, "type": "Line"}, {"lineNumber": 6, "content": "INFO: Running with entropic power schedule (0xFF, 100).", "important": false, "type": "Line"}, {"lineNumber": 7, "content": "INFO: Seed: 1776401984", "important": false, "type": "Line"}, {"lineNumber": 8, "content": "INFO: Loaded 1 modules   (247064 inline 8-bit counters): 247064 [0x3f174d0, 0x3f539e8),", "important": false, "type": "Line"}, {"lineNumber": 9, "content": "INFO: Loaded 1 PC tables (247064 PCs): 247064 [0x3f539e8,0x4318b68),", "important": false, "type": "Line"}, {"lineNumber": 10, "content": "/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer: Running 1 inputs 100 time(s) each.", "important": false, "type": "Line"}, {"lineNumber": 11, "content": "Running: /clusterfuzz/run_bot/clusterfuzz/bot/inputs/fuzzer-testcases/bc4530b26dddee45f320a14b4e30f2218a3ec3f6285f0d5b7b0078d2429910f9", "important": false, "type": "Line"}, {"lineNumber": 12, "content": "=================================================================", "important": false, "type": "Line"}, {"lineNumber": 13, "content": "==4029==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62b000006d80 at pc 0x00000052a657 bp 0x7fe209ef7490 sp 0x7fe209ef6c58", "important": false, "type": "Line"}, {"lineNumber": 14, "content": "READ of size 512 at 0x62b000006d80 thread T2", "important": false, "type": "Line"}, {"lineNumber": 15, "content": "    #0 0x52a656 in __asan_memcpy /src/llvm-project/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:22:3", "important": false, "type": "Line"}, {"lineNumber": 16, "content": "    #1 0x2dfcb17 in CopyImageTo&lt;int&gt; /src/libjxl/lib/jxl/image_ops.h:55:5", "important": false, "type": "Line"}, {"lineNumber": 17, "content": "    #2 0x2dfcb17 in jxl::ModularFrameDecoder::DecodeGroup(jxl::Rect const&amp;, jxl::BitReader*, int, int, jxl::ModularStreamId const&amp;, bool, jxl::PassesDecoderState*, jxl::ImageBundle*, bool) /src/libjxl/lib/jxl/dec_modular.cc:334:5", "important": true, "type": "Line"}, {"lineNumber": 18, "content": "    #3 0x2cb7a29 in jxl::FrameDecoder::ProcessACGroup(unsigned long, jxl::BitReader* restrict*, unsigned long, unsigned long, bool, bool) /src/libjxl/lib/jxl/dec_frame.cc:638:7", "important": true, "type": "Line"}, {"lineNumber": 19, "content": "    #4 0x2cc1134 in operator() /src/libjxl/lib/jxl/dec_frame.cc:790:16", "important": false, "type": "Line"}, {"lineNumber": 20, "content": "    #5 0x2cc1134 in jxl::ThreadPool::RunCallState&lt;jxl::FrameDecoder::ProcessSections(jxl::FrameDecoder::SectionInfo const*, unsigned long, jxl::FrameDecoder::SectionStatus*)::$_1, jxl::FrameDecoder::ProcessSections(jxl::FrameDecoder::SectionInfo const*, unsigned long, jxl::FrameDecoder::SectionStatus*)::$_2&gt;::CallDataFunc(void*, unsigned int, unsigned long) /src/libjxl/lib/jxl/base/data_parallel.h:88:14", "important": true, "type": "Line"}, {"lineNumber": 21, "content": "    #6 0x3215564 in RunRange /src/libjxl/lib/threads/thread_parallel_runner_internal.cc:139:7", "important": false, "type": "Line"}, {"lineNumber": 22, "content": "    #7 0x3215564 in jpegxl::ThreadParallelRunner::ThreadFunc(jpegxl::ThreadParallelRunner*, int) /src/libjxl/lib/threads/thread_parallel_runner_internal.cc:169:9", "important": false, "type": "Line"}, {"lineNumber": 23, "content": "    #8 0x32177a3 in __invoke&lt;void (*)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int&gt; /usr/local/include/c++/v1/type_traits:3662:23", "important": false, "type": "Line"}, {"lineNumber": 24, "content": "    #9 0x32177a3 in __thread_execute&lt;std::__1::unique_ptr&lt;std::__1::__thread_struct, std::__1::default_delete&lt;std::__1::__thread_struct&gt; &gt;, void (*)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int, 2UL, 3UL&gt; /usr/local/include/c++/v1/thread:280:5", "important": false, "type": "Line"}, {"lineNumber": 25, "content": "    #10 0x32177a3 in void* std::__1::__thread_proxy&lt;std::__1::tuple&lt;std::__1::unique_ptr&lt;std::__1::__thread_struct, std::__1::default_delete&lt;std::__1::__thread_struct&gt; &gt;, void (*)(jpegxl::ThreadParallelRunner*, int), jpegxl::ThreadParallelRunner*, unsigned int&gt; &gt;(void*) /usr/local/include/c++/v1/thread:291:5", "important": false, "type": "Line"}, {"lineNumber": 26, "content": "    #11 0x7fe20d8ae608 in start_thread", "important": false, "type": "Line"}, {"lineNumber": 27, "content": "    #12 0x7fe20d7a9292 in __clone", "important": false, "type": "Line"}, {"lineNumber": 28, "content": "", "important": false, "type": "Line"}, {"lineNumber": 29, "content": "0x62b000006d80 is located 0 bytes to the right of 27520-byte region [0x62b000000200,0x62b000006d80)", "important": false, "type": "Line"}, {"lineNumber": 30, "content": "allocated by thread T2 here:", "important": false, "type": "Line"}, {"lineNumber": 31, "content": "    #0 0x52b29d in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:129:3", "important": false, "type": "Line"}, {"lineNumber": 32, "content": "    #1 0x2636186 in jxl::CacheAligned::Allocate(unsigned long, unsigned long) /src/libjxl/lib/jxl/base/cache_aligned.cc:87:21", "important": false, "type": "Line"}, {"lineNumber": 33, "content": "    #2 0x269c9f7 in Allocate /src/libjxl/lib/jxl/base/cache_aligned.h:43:12", "important": false, "type": "Line"}, {"lineNumber": 34, "content": "    #3 0x269c9f7 in AllocateArray /src/libjxl/lib/jxl/base/cache_aligned.h:61:29", "important": false, "type": "Line"}, {"lineNumber": 35, "content": "    #4 0x269c9f7 in jxl::PlaneBase::PlaneBase(unsigned long, unsigned long, unsigned long) /src/libjxl/lib/jxl/image.cc:93:14", "important": false, "type": "Line"}, {"lineNumber": 36, "content": "    #5 0x2ee2636 in Plane /src/libjxl/lib/jxl/image.h:149:9", "important": false, "type": "Line"}, {"lineNumber": 37, "content": "    #6 0x2ee2636 in shrink /src/libjxl/lib/jxl/modular/modular_image.h:60:28", "important": false, "type": "Line"}, {"lineNumber": 38, "content": "    #7 0x2ee2636 in jxl::MetaSqueeze(jxl::Image&amp;, std::__1::vector&lt;jxl::SqueezeParams, std::__1::allocator&lt;jxl::SqueezeParams&gt; &gt;*) /src/libjxl/lib/jxl/modular/transform/squeeze.cc:273:24", "important": false, "type": "Line"}, {"lineNumber": 39, "content": "    #8 0x272a7ed in jxl::Transform::MetaApply(jxl::Image&amp;) /src/libjxl/lib/jxl/modular/transform/transform.cc:65:14", "important": false, "type": "Line"}, {"lineNumber": 40, "content": "    #9 0x27189b7 in jxl::ModularDecode(jxl::BitReader*, jxl::Image&amp;, jxl::GroupHeader&amp;, unsigned long, jxl::ModularOptions*, std::__1::vector&lt;jxl::PropertyDecisionNode, std::__1::allocator&lt;jxl::PropertyDecisionNode&gt; &gt; const*, jxl::ANSCode const*, std::__1::vector&lt;unsigned char, std::__1::allocator&lt;unsigned char&gt; &gt; const*, bool) /src/libjxl/lib/jxl/modular/encoding/encoding.cc:395:5", "important": false, "type": "Line"}, {"lineNumber": 41, "content": "    #10 0x271a5fa in jxl::ModularGenericDecompress(jxl::BitReader*, jxl::Image&amp;, jxl::GroupHeader*, unsigned long, jxl::ModularOptions*, bool, std::__1::vector&lt;jxl::PropertyDecisionNode, std::__1::allocator&lt;jxl::PropertyDecisionNode&gt; &gt; const*, jxl::ANSCode const*, std::__1::vector&lt;unsigned char, std::__1::allocator&lt;unsigned char&gt; &gt; const*, bool) /src/libjxl/lib/jxl/modular/encoding/encoding.cc:506:21", "important": false, "type": "Line"}, {"lineNumber": 42, "content": "    #11 0x2dfc541 in jxl::ModularFrameDecoder::DecodeGroup(jxl::Rect const&amp;, jxl::BitReader*, int, int, jxl::ModularStreamId const&amp;, bool, jxl::PassesDecoderState*, jxl::ImageBundle*, bool) /src/libjxl/lib/jxl/dec_modular.cc:307:10", "important": true, "type": "Line"}, {"lineNumber": 43, "content": "    #12 0x2cb7a29 in jxl::FrameDecoder::ProcessACGroup(unsigned long, jxl::BitReader* restrict*, unsigned long, unsigned long, bool, bool) /src/libjxl/lib/jxl/dec_frame.cc:638:7", "important": true, "type": "Line"}, {"lineNumber": 44, "content": "    #13 0x2cc1134 in operator() /src/libjxl/lib/jxl/dec_frame.cc:790:16", "important": false, "type": "Line"}, {"lineNumber": 45, "content": "    #14 0x2cc1134 in jxl::ThreadPool::RunCallState&lt;jxl::FrameDecoder::ProcessSections(jxl::FrameDecoder::SectionInfo const*, unsigned long, jxl::FrameDecoder::SectionStatus*)::$_1, jxl::FrameDecoder::ProcessSections(jxl::FrameDecoder::SectionInfo const*, unsigned long, jxl::FrameDecoder::SectionStatus*)::$_2&gt;::CallDataFunc(void*, unsigned int, unsigned long) /src/libjxl/lib/jxl/base/data_parallel.h:88:14", "important": true, "type": "Line"}, {"lineNumber": 46, "content": "    #15 0x3215564 in RunRange /src/libjxl/lib/threads/thread_parallel_runner_internal.cc:139:7", "important": false, "type": "Line"}, {"lineNumber": 47, "content": "    #16 0x3215564 in jpegxl::ThreadParallelRunner::ThreadFunc(jpegxl::ThreadParallelRunner*, int) /src/libjxl/lib/threads/thread_parallel_runner_internal.cc:169:9", "important": false, "type": "Line"}, {"lineNumber": 48, "content": "    #17 0x32177a3 in __invoke&lt;void (*)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int&gt; /usr/local/include/c++/v1/type_traits:3662:23", "important": false, "type": "Line"}, {"lineNumber": 49, "content": "    #18 0x32177a3 in __thread_execute&lt;std::__1::unique_ptr&lt;std::__1::__thread_struct, std::__1::default_delete&lt;std::__1::__thread_struct&gt; &gt;, void (*)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int, 2UL, 3UL&gt; /usr/local/include/c++/v1/thread:280:5", "important": false, "type": "Line"}, {"lineNumber": 50, "content": "    #19 0x32177a3 in void* std::__1::__thread_proxy&lt;std::__1::tuple&lt;std::__1::unique_ptr&lt;std::__1::__thread_struct, std::__1::default_delete&lt;std::__1::__thread_struct&gt; &gt;, void (*)(jpegxl::ThreadParallelRunner*, int), jpegxl::ThreadParallelRunner*, unsigned int&gt; &gt;(void*) /usr/local/include/c++/v1/thread:291:5", "important": false, "type": "Line"}, {"lineNumber": 51, "content": "    #20 0x7fe20d8ae608 in start_thread", "important": false, "type": "Line"}, {"lineNumber": 52, "content": "", "important": false, "type": "Line"}, {"lineNumber": 53, "content": "Thread T2 created by T0 here:", "important": false, "type": "Line"}, {"lineNumber": 54, "content": "    #0 0x51499c in __interceptor_pthread_create /src/llvm-project/compiler-rt/lib/asan/asan_interceptors.cpp:207:3", "important": false, "type": "Line"}, {"lineNumber": 55, "content": "    #1 0x3215c9d in __libcpp_thread_create /usr/local/include/c++/v1/__threading_support:514:10", "important": false, "type": "Line"}, {"lineNumber": 56, "content": "    #2 0x3215c9d in thread&lt;void (&amp;)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int &amp;, void&gt; /usr/local/include/c++/v1/thread:307:16", "important": false, "type": "Line"}, {"lineNumber": 57, "content": "    #3 0x3215c9d in construct&lt;std::__1::thread, void (&amp;)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int &amp;&gt; /usr/local/include/c++/v1/__memory/allocator.h:151:28", "important": false, "type": "Line"}, {"lineNumber": 58, "content": "    #4 0x3215c9d in construct&lt;std::__1::thread, void (&amp;)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int &amp;, void&gt; /usr/local/include/c++/v1/__memory/allocator_traits.h:290:13", "important": false, "type": "Line"}, {"lineNumber": 59, "content": "    #5 0x3215c9d in __construct_one_at_end&lt;void (&amp;)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int &amp;&gt; /usr/local/include/c++/v1/vector:933:5", "important": false, "type": "Line"}, {"lineNumber": 60, "content": "    #6 0x3215c9d in emplace_back&lt;void (&amp;)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int &amp;&gt; /usr/local/include/c++/v1/vector:1693:9", "important": false, "type": "Line"}, {"lineNumber": 61, "content": "    #7 0x3215c9d in jpegxl::ThreadParallelRunner::ThreadParallelRunner(int) /src/libjxl/lib/threads/thread_parallel_runner_internal.cc:196:14", "important": false, "type": "Line"}, {"lineNumber": 62, "content": "    #8 0x32143b8 in JxlThreadParallelRunnerCreate /src/libjxl/lib/threads/thread_parallel_runner.cc:81:19", "important": false, "type": "Line"}, {"lineNumber": 63, "content": "    #9 0x7b8337 in vips_foreign_load_jxl_build /src/libvips/libvips/foreign/jxlload.c:158:16", "important": false, "type": "Line"}, {"lineNumber": 64, "content": "    #10 0x7ba88b in vips_foreign_load_jxl_buffer_build /src/libvips/libvips/foreign/jxlload.c:828:6", "important": false, "type": "Line"}, {"lineNumber": 65, "content": "    #11 0x58423e in vips_object_build /src/libvips/libvips/iofuncs/object.c:367:6", "important": false, "type": "Line"}, {"lineNumber": 66, "content": "    #12 0x869f08 in vips_cache_operation_buildp /src/libvips/libvips/iofuncs/cache.c:910:7", "important": false, "type": "Line"}, {"lineNumber": 67, "content": "    #13 0x593e97 in vips_call_required_optional /src/libvips/libvips/iofuncs/operation.c:880:6", "important": false, "type": "Line"}, {"lineNumber": 68, "content": "    #14 0x596bd9 in vips_call_by_name /src/libvips/libvips/iofuncs/operation.c:920:11", "important": false, "type": "Line"}, {"lineNumber": 69, "content": "    #15 0x596f94 in vips_call_split_option_string /src/libvips/libvips/iofuncs/operation.c:1039:11", "important": false, "type": "Line"}, {"lineNumber": 70, "content": "    #16 0x577101 in vips_image_new_from_buffer /src/libvips/libvips/iofuncs/image.c:2158:11", "important": false, "type": "Line"}, {"lineNumber": 71, "content": "    #17 0x56464e in LLVMFuzzerTestOneInput /src/libvips/fuzz/pngsave_buffer_fuzzer.cc:20:16", "important": false, "type": "Line"}, {"lineNumber": 72, "content": "    #18 0x45c0d3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) cxa_noexception.cpp:0", "important": false, "type": "Line"}, {"lineNumber": 73, "content": "    #19 0x4479e2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6", "important": false, "type": "Line"}, {"lineNumber": 74, "content": "    #20 0x44d4aa in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) cxa_noexception.cpp:0", "important": false, "type": "Line"}, {"lineNumber": 75, "content": "    #21 0x4763d2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10", "important": false, "type": "Line"}, {"lineNumber": 76, "content": "    #22 0x7fe20d6ae0b2 in __libc_start_main", "important": false, "type": "Line"}, {"lineNumber": 77, "content": "", "important": false, "type": "Line"}, {"lineNumber": 78, "content": "SUMMARY: AddressSanitizer: heap-buffer-overflow (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x52a656)", "important": false, "type": "Line"}, {"lineNumber": 79, "content": "Shadow bytes around the buggy address:", "important": false, "type": "Line"}, {"lineNumber": 80, "content": "  0x0c567fff8d60: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00", "important": false, "type": "Line"}, {"lineNumber": 81, "content": "  0x0c567fff8d70: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00", "important": false, "type": "Line"}, {"lineNumber": 82, "content": "  0x0c567fff8d80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00", "important": false, "type": "Line"}, {"lineNumber": 83, "content": "  0x0c567fff8d90: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00", "important": false, "type": "Line"}, {"lineNumber": 84, "content": "  0x0c567fff8da0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00", "important": false, "type": "Line"}, {"lineNumber": 85, "content": "=&gt;0x0c567fff8db0:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa", "important": false, "type": "Line"}, {"lineNumber": 86, "content": "  0x0c567fff8dc0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa", "important": false, "type": "Line"}, {"lineNumber": 87, "content": "  0x0c567fff8dd0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa", "important": false, "type": "Line"}, {"lineNumber": 88, "content": "  0x0c567fff8de0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa", "important": false, "type": "Line"}, {"lineNumber": 89, "content": "  0x0c567fff8df0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa", "important": false, "type": "Line"}, {"lineNumber": 90, "content": "  0x0c567fff8e00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa", "important": false, "type": "Line"}, {"lineNumber": 91, "content": "Shadow byte legend (one shadow byte represents 8 application bytes):", "important": false, "type": "Line"}, {"lineNumber": 92, "content": "  Addressable:           00", "important": false, "type": "Line"}, {"lineNumber": 93, "content": "  Partially addressable: 01 02 03 04 05 06 07", "important": false, "type": "Line"}, {"lineNumber": 94, "content": "  Heap left redzone:       fa", "important": false, "type": "Line"}, {"lineNumber": 95, "content": "  Freed heap region:       fd", "important": false, "type": "Line"}, {"lineNumber": 96, "content": "  Stack left redzone:      f1", "important": false, "type": "Line"}, {"lineNumber": 97, "content": "  Stack mid redzone:       f2", "important": false, "type": "Line"}, {"lineNumber": 98, "content": "  Stack right redzone:     f3", "important": false, "type": "Line"}, {"lineNumber": 99, "content": "  Stack after return:      f5", "important": false, "type": "Line"}, {"lineNumber": 100, "content": "  Stack use after scope:   f8", "important": false, "type": "Line"}, {"lineNumber": 101, "content": "  Global redzone:          f9", "important": false, "type": "Line"}, {"lineNumber": 102, "content": "  Global init order:       f6", "important": false, "type": "Line"}, {"lineNumber": 103, "content": "  Poisoned by user:        f7", "important": false, "type": "Line"}, {"lineNumber": 104, "content": "  Container overflow:      fc", "important": false, "type": "Line"}, {"lineNumber": 105, "content": "  Array cookie:            ac", "important": false, "type": "Line"}, {"lineNumber": 106, "content": "  Intra object redzone:    bb", "important": false, "type": "Line"}, {"lineNumber": 107, "content": "  ASan internal:           fe", "important": false, "type": "Line"}, {"lineNumber": 108, "content": "  Left alloca redzone:     ca", "important": false, "type": "Line"}, {"lineNumber": 109, "content": "  Right alloca redzone:    cb", "important": false, "type": "Line"}, {"lineNumber": 110, "content": "==4029==ABORTING", "important": false, "type": "Line"}, {"lineNumber": 111, "content": "", "important": false, "type": "Line"}, {"lineNumber": 112, "content": "", "important": false, "type": "Line"}, {"lineNumber": 113, "content": "+----------------------------------------Release Build Unsymbolized Stacktrace (diff)----------------------------------------+", "important": false, "type": "Line"}, {"lineNumber": 114, "content": "", "important": false, "type": "Line"}, {"lineNumber": 115, "content": "==4029==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62b000006d80 at pc 0x00000052a657 bp 0x7fe209ef7490 sp 0x7fe209ef6c58", "important": false, "type": "Line"}, {"lineNumber": 116, "content": "READ of size 512 at 0x62b000006d80 thread T2", "important": false, "type": "Line"}, {"lineNumber": 117, "content": "    #0 0x52a656  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x52a656)", "important": false, "type": "Line"}, {"lineNumber": 118, "content": "    #1 0x2dfcb17  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x2dfcb17)", "important": false, "type": "Line"}, {"lineNumber": 119, "content": "    #2 0x2cb7a29  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x2cb7a29)", "important": false, "type": "Line"}, {"lineNumber": 120, "content": "    #3 0x2cc1134  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x2cc1134)", "important": false, "type": "Line"}, {"lineNumber": 121, "content": "    #4 0x3215564  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x3215564)", "important": false, "type": "Line"}, {"lineNumber": 122, "content": "    #5 0x32177a3  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x32177a3)", "important": false, "type": "Line"}, {"lineNumber": 123, "content": "    #6 0x7fe20d8ae608  (/lib/x86_64-linux-gnu/libpthread.so.0+0x9608)", "important": false, "type": "Line"}, {"lineNumber": 124, "content": "    #7 0x7fe20d7a9292  (/lib/x86_64-linux-gnu/libc.so.6+0x122292)", "important": false, "type": "Line"}, {"lineNumber": 125, "content": "", "important": false, "type": "Line"}, {"lineNumber": 126, "content": "0x62b000006d80 is located 0 bytes to the right of 27520-byte region [0x62b000000200,0x62b000006d80)", "important": false, "type": "Line"}, {"lineNumber": 127, "content": "allocated by thread T2 here:", "important": false, "type": "Line"}, {"lineNumber": 128, "content": "    #0 0x52b29d  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x52b29d)", "important": false, "type": "Line"}, {"lineNumber": 129, "content": "    #1 0x2636186  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x2636186)", "important": false, "type": "Line"}, {"lineNumber": 130, "content": "    #2 0x269c9f7  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x269c9f7)", "important": false, "type": "Line"}, {"lineNumber": 131, "content": "    #3 0x2ee2636  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x2ee2636)", "important": false, "type": "Line"}, {"lineNumber": 132, "content": "    #4 0x272a7ed  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x272a7ed)", "important": false, "type": "Line"}, {"lineNumber": 133, "content": "    #5 0x27189b7  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x27189b7)", "important": false, "type": "Line"}, {"lineNumber": 134, "content": "    #6 0x271a5fa  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x271a5fa)", "important": false, "type": "Line"}, {"lineNumber": 135, "content": "    #7 0x2dfc541  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x2dfc541)", "important": false, "type": "Line"}, {"lineNumber": 136, "content": "    #8 0x2cb7a29  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x2cb7a29)", "important": false, "type": "Line"}, {"lineNumber": 137, "content": "    #9 0x2cc1134  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x2cc1134)", "important": false, "type": "Line"}, {"lineNumber": 138, "content": "    #10 0x3215564  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x3215564)", "important": false, "type": "Line"}, {"lineNumber": 139, "content": "    #11 0x32177a3  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x32177a3)", "important": false, "type": "Line"}, {"lineNumber": 140, "content": "    #12 0x7fe20d8ae608  (/lib/x86_64-linux-gnu/libpthread.so.0+0x9608)", "important": false, "type": "Line"}, {"lineNumber": 141, "content": "", "important": false, "type": "Line"}, {"lineNumber": 142, "content": "Thread T2 created by T0 here:", "important": false, "type": "Line"}, {"lineNumber": 143, "content": "    #0 0x51499c  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x51499c)", "important": false, "type": "Line"}, {"lineNumber": 144, "content": "    #1 0x3215c9d  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x3215c9d)", "important": false, "type": "Line"}, {"lineNumber": 145, "content": "    #2 0x32143b8  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x32143b8)", "important": false, "type": "Line"}, {"lineNumber": 146, "content": "    #3 0x7b8337  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x7b8337)", "important": false, "type": "Line"}, {"lineNumber": 147, "content": "    #4 0x7ba88b  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x7ba88b)", "important": false, "type": "Line"}, {"lineNumber": 148, "content": "    #5 0x58423e  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x58423e)", "important": false, "type": "Line"}, {"lineNumber": 149, "content": "    #6 0x869f08  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x869f08)", "important": false, "type": "Line"}, {"lineNumber": 150, "content": "    #7 0x593e97  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x593e97)", "important": false, "type": "Line"}, {"lineNumber": 151, "content": "    #8 0x596bd9  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x596bd9)", "important": false, "type": "Line"}, {"lineNumber": 152, "content": "    #9 0x596f94  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x596f94)", "important": false, "type": "Line"}, {"lineNumber": 153, "content": "    #10 0x577101  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x577101)", "important": false, "type": "Line"}, {"lineNumber": 154, "content": "    #11 0x56464e  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x56464e)", "important": false, "type": "Line"}, {"lineNumber": 155, "content": "    #12 0x45c0d3  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x45c0d3)", "important": false, "type": "Line"}, {"lineNumber": 156, "content": "    #13 0x4479e2  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x4479e2)", "important": false, "type": "Line"}, {"lineNumber": 157, "content": "    #14 0x44d4aa  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x44d4aa)", "important": false, "type": "Line"}, {"lineNumber": 158, "content": "    #15 0x4763d2  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x4763d2)", "important": false, "type": "Line"}, {"lineNumber": 159, "content": "    #16 0x7fe20d6ae0b2  (/lib/x86_64-linux-gnu/libc.so.6+0x270b2)", "important": false, "type": "Line"}], "revision": "1"}, "last_tested_crash_stacktrace": {"lines": [], "revision": null}, "security_severity": "Medium", "security_severities": [{"value": 0, "name": "Critical"}, {"value": 1, "name": "High", "default": true}, {"value": 2, "name": "Medium"}, {"value": 3, "name": "Low"}, {"value": 4, "name": "Missing"}], "stats": {"min_hour": 1, "max_hour": 1}, "suspected_cls": null, "testcase": {"absolute_path": "/clusterfuzz/run_bot/clusterfuzz/bot/inputs/fuzzer-testcases/crash-5382d8ba8a3ec3f6285f0d5b7b0078d2429910f9", "additional_metadata": "{\"build_key\": \"f6591c65-0eac-4d5c-a59f-6ebe3515c9e3\", \"env\": {\"ASAN_OPTIONS\": {}}, \"fuzzer_binary_name\": \"pngsave_buffer_fuzzer\", \"fuzzing_strategies\": {\"corpus_mutations_radamsa\": 1, \"corpus_subset\": 125, \"value_profile\": 1}}", "archive_filename": null, "archive_state": 0, "binary_flag": true, "bug_indices": [], "bug_information": "", "comments": "[2021-12-02 14:32:51 UTC] comput15-20211129-15:14: Fuzz task : Fuzzer libFuzzer_pngsave_buffer_fuzzer generated testcase crashed in 693 seconds (r1).\n[2021-12-02 14:58:08 UTC] snode9-20211129-17:29: Minimize task started.\n[2021-12-02 15:26:25 UTC] snode9-20211129-17:29: Minimize task finished.\n", "crash_address": "0x62b000006d80", "crash_revision": 1, "crash_stacktrace": "[Environment] ASAN_OPTIONS=exitcode=77\n+----------------------------------------Release Build Stacktrace----------------------------------------+\nCommand: /clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer -rss_limit_mb=2560 -timeout=60 -runs=100 /clusterfuzz/run_bot/clusterfuzz/bot/inputs/fuzzer-testcases/bc4530b26dddee45f320a14b4e30f2218a3ec3f6285f0d5b7b0078d2429910f9\nTime ran: 0.07726836204528809\n\nINFO: Running with entropic power schedule (0xFF, 100).\nINFO: Seed: 1776401984\nINFO: Loaded 1 modules   (247064 inline 8-bit counters): 247064 [0x3f174d0, 0x3f539e8),\nINFO: Loaded 1 PC tables (247064 PCs): 247064 [0x3f539e8,0x4318b68),\n/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer: Running 1 inputs 100 time(s) each.\nRunning: /clusterfuzz/run_bot/clusterfuzz/bot/inputs/fuzzer-testcases/bc4530b26dddee45f320a14b4e30f2218a3ec3f6285f0d5b7b0078d2429910f9\n=================================================================\n==4029==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62b000006d80 at pc 0x00000052a657 bp 0x7fe209ef7490 sp 0x7fe209ef6c58\nREAD of size 512 at 0x62b000006d80 thread T2\n    #0 0x52a656 in __asan_memcpy /src/llvm-project/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:22:3\n    #1 0x2dfcb17 in CopyImageTo<int> /src/libjxl/lib/jxl/image_ops.h:55:5\n    #2 0x2dfcb17 in jxl::ModularFrameDecoder::DecodeGroup(jxl::Rect const&, jxl::BitReader*, int, int, jxl::ModularStreamId const&, bool, jxl::PassesDecoderState*, jxl::ImageBundle*, bool) /src/libjxl/lib/jxl/dec_modular.cc:334:5\n    #3 0x2cb7a29 in jxl::FrameDecoder::ProcessACGroup(unsigned long, jxl::BitReader* restrict*, unsigned long, unsigned long, bool, bool) /src/libjxl/lib/jxl/dec_frame.cc:638:7\n    #4 0x2cc1134 in operator() /src/libjxl/lib/jxl/dec_frame.cc:790:16\n    #5 0x2cc1134 in jxl::ThreadPool::RunCallState<jxl::FrameDecoder::ProcessSections(jxl::FrameDecoder::SectionInfo const*, unsigned long, jxl::FrameDecoder::SectionStatus*)::$_1, jxl::FrameDecoder::ProcessSections(jxl::FrameDecoder::SectionInfo const*, unsigned long, jxl::FrameDecoder::SectionStatus*)::$_2>::CallDataFunc(void*, unsigned int, unsigned long) /src/libjxl/lib/jxl/base/data_parallel.h:88:14\n    #6 0x3215564 in RunRange /src/libjxl/lib/threads/thread_parallel_runner_internal.cc:139:7\n    #7 0x3215564 in jpegxl::ThreadParallelRunner::ThreadFunc(jpegxl::ThreadParallelRunner*, int) /src/libjxl/lib/threads/thread_parallel_runner_internal.cc:169:9\n    #8 0x32177a3 in __invoke<void (*)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int> /usr/local/include/c++/v1/type_traits:3662:23\n    #9 0x32177a3 in __thread_execute<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct> >, void (*)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int, 2UL, 3UL> /usr/local/include/c++/v1/thread:280:5\n    #10 0x32177a3 in void* std::__1::__thread_proxy<std::__1::tuple<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct> >, void (*)(jpegxl::ThreadParallelRunner*, int), jpegxl::ThreadParallelRunner*, unsigned int> >(void*) /usr/local/include/c++/v1/thread:291:5\n    #11 0x7fe20d8ae608 in start_thread\n    #12 0x7fe20d7a9292 in __clone\n\n0x62b000006d80 is located 0 bytes to the right of 27520-byte region [0x62b000000200,0x62b000006d80)\nallocated by thread T2 here:\n    #0 0x52b29d in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:129:3\n    #1 0x2636186 in jxl::CacheAligned::Allocate(unsigned long, unsigned long) /src/libjxl/lib/jxl/base/cache_aligned.cc:87:21\n    #2 0x269c9f7 in Allocate /src/libjxl/lib/jxl/base/cache_aligned.h:43:12\n    #3 0x269c9f7 in AllocateArray /src/libjxl/lib/jxl/base/cache_aligned.h:61:29\n    #4 0x269c9f7 in jxl::PlaneBase::PlaneBase(unsigned long, unsigned long, unsigned long) /src/libjxl/lib/jxl/image.cc:93:14\n    #5 0x2ee2636 in Plane /src/libjxl/lib/jxl/image.h:149:9\n    #6 0x2ee2636 in shrink /src/libjxl/lib/jxl/modular/modular_image.h:60:28\n    #7 0x2ee2636 in jxl::MetaSqueeze(jxl::Image&, std::__1::vector<jxl::SqueezeParams, std::__1::allocator<jxl::SqueezeParams> >*) /src/libjxl/lib/jxl/modular/transform/squeeze.cc:273:24\n    #8 0x272a7ed in jxl::Transform::MetaApply(jxl::Image&) /src/libjxl/lib/jxl/modular/transform/transform.cc:65:14\n    #9 0x27189b7 in jxl::ModularDecode(jxl::BitReader*, jxl::Image&, jxl::GroupHeader&, unsigned long, jxl::ModularOptions*, std::__1::vector<jxl::PropertyDecisionNode, std::__1::allocator<jxl::PropertyDecisionNode> > const*, jxl::ANSCode const*, std::__1::vector<unsigned char, std::__1::allocator<unsigned char> > const*, bool) /src/libjxl/lib/jxl/modular/encoding/encoding.cc:395:5\n    #10 0x271a5fa in jxl::ModularGenericDecompress(jxl::BitReader*, jxl::Image&, jxl::GroupHeader*, unsigned long, jxl::ModularOptions*, bool, std::__1::vector<jxl::PropertyDecisionNode, std::__1::allocator<jxl::PropertyDecisionNode> > const*, jxl::ANSCode const*, std::__1::vector<unsigned char, std::__1::allocator<unsigned char> > const*, bool) /src/libjxl/lib/jxl/modular/encoding/encoding.cc:506:21\n    #11 0x2dfc541 in jxl::ModularFrameDecoder::DecodeGroup(jxl::Rect const&, jxl::BitReader*, int, int, jxl::ModularStreamId const&, bool, jxl::PassesDecoderState*, jxl::ImageBundle*, bool) /src/libjxl/lib/jxl/dec_modular.cc:307:10\n    #12 0x2cb7a29 in jxl::FrameDecoder::ProcessACGroup(unsigned long, jxl::BitReader* restrict*, unsigned long, unsigned long, bool, bool) /src/libjxl/lib/jxl/dec_frame.cc:638:7\n    #13 0x2cc1134 in operator() /src/libjxl/lib/jxl/dec_frame.cc:790:16\n    #14 0x2cc1134 in jxl::ThreadPool::RunCallState<jxl::FrameDecoder::ProcessSections(jxl::FrameDecoder::SectionInfo const*, unsigned long, jxl::FrameDecoder::SectionStatus*)::$_1, jxl::FrameDecoder::ProcessSections(jxl::FrameDecoder::SectionInfo const*, unsigned long, jxl::FrameDecoder::SectionStatus*)::$_2>::CallDataFunc(void*, unsigned int, unsigned long) /src/libjxl/lib/jxl/base/data_parallel.h:88:14\n    #15 0x3215564 in RunRange /src/libjxl/lib/threads/thread_parallel_runner_internal.cc:139:7\n    #16 0x3215564 in jpegxl::ThreadParallelRunner::ThreadFunc(jpegxl::ThreadParallelRunner*, int) /src/libjxl/lib/threads/thread_parallel_runner_internal.cc:169:9\n    #17 0x32177a3 in __invoke<void (*)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int> /usr/local/include/c++/v1/type_traits:3662:23\n    #18 0x32177a3 in __thread_execute<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct> >, void (*)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int, 2UL, 3UL> /usr/local/include/c++/v1/thread:280:5\n    #19 0x32177a3 in void* std::__1::__thread_proxy<std::__1::tuple<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct> >, void (*)(jpegxl::ThreadParallelRunner*, int), jpegxl::ThreadParallelRunner*, unsigned int> >(void*) /usr/local/include/c++/v1/thread:291:5\n    #20 0x7fe20d8ae608 in start_thread\n\nThread T2 created by T0 here:\n    #0 0x51499c in __interceptor_pthread_create /src/llvm-project/compiler-rt/lib/asan/asan_interceptors.cpp:207:3\n    #1 0x3215c9d in __libcpp_thread_create /usr/local/include/c++/v1/__threading_support:514:10\n    #2 0x3215c9d in thread<void (&)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int &, void> /usr/local/include/c++/v1/thread:307:16\n    #3 0x3215c9d in construct<std::__1::thread, void (&)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int &> /usr/local/include/c++/v1/__memory/allocator.h:151:28\n    #4 0x3215c9d in construct<std::__1::thread, void (&)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int &, void> /usr/local/include/c++/v1/__memory/allocator_traits.h:290:13\n    #5 0x3215c9d in __construct_one_at_end<void (&)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int &> /usr/local/include/c++/v1/vector:933:5\n    #6 0x3215c9d in emplace_back<void (&)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int &> /usr/local/include/c++/v1/vector:1693:9\n    #7 0x3215c9d in jpegxl::ThreadParallelRunner::ThreadParallelRunner(int) /src/libjxl/lib/threads/thread_parallel_runner_internal.cc:196:14\n    #8 0x32143b8 in JxlThreadParallelRunnerCreate /src/libjxl/lib/threads/thread_parallel_runner.cc:81:19\n    #9 0x7b8337 in vips_foreign_load_jxl_build /src/libvips/libvips/foreign/jxlload.c:158:16\n    #10 0x7ba88b in vips_foreign_load_jxl_buffer_build /src/libvips/libvips/foreign/jxlload.c:828:6\n    #11 0x58423e in vips_object_build /src/libvips/libvips/iofuncs/object.c:367:6\n    #12 0x869f08 in vips_cache_operation_buildp /src/libvips/libvips/iofuncs/cache.c:910:7\n    #13 0x593e97 in vips_call_required_optional /src/libvips/libvips/iofuncs/operation.c:880:6\n    #14 0x596bd9 in vips_call_by_name /src/libvips/libvips/iofuncs/operation.c:920:11\n    #15 0x596f94 in vips_call_split_option_string /src/libvips/libvips/iofuncs/operation.c:1039:11\n    #16 0x577101 in vips_image_new_from_buffer /src/libvips/libvips/iofuncs/image.c:2158:11\n    #17 0x56464e in LLVMFuzzerTestOneInput /src/libvips/fuzz/pngsave_buffer_fuzzer.cc:20:16\n    #18 0x45c0d3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) cxa_noexception.cpp:0\n    #19 0x4479e2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6\n    #20 0x44d4aa in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) cxa_noexception.cpp:0\n    #21 0x4763d2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n    #22 0x7fe20d6ae0b2 in __libc_start_main\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x52a656)\nShadow bytes around the buggy address:\n  0x0c567fff8d60: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c567fff8d70: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c567fff8d80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c567fff8d90: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c567fff8da0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n=>0x0c567fff8db0:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c567fff8dc0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c567fff8dd0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c567fff8de0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c567fff8df0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c567fff8e00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07\n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==4029==ABORTING\n\n\n+----------------------------------------Release Build Unsymbolized Stacktrace (diff)----------------------------------------+\n\n==4029==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62b000006d80 at pc 0x00000052a657 bp 0x7fe209ef7490 sp 0x7fe209ef6c58\nREAD of size 512 at 0x62b000006d80 thread T2\n    #0 0x52a656  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x52a656)\n    #1 0x2dfcb17  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x2dfcb17)\n    #2 0x2cb7a29  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x2cb7a29)\n    #3 0x2cc1134  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x2cc1134)\n    #4 0x3215564  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x3215564)\n    #5 0x32177a3  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x32177a3)\n    #6 0x7fe20d8ae608  (/lib/x86_64-linux-gnu/libpthread.so.0+0x9608)\n    #7 0x7fe20d7a9292  (/lib/x86_64-linux-gnu/libc.so.6+0x122292)\n\n0x62b000006d80 is located 0 bytes to the right of 27520-byte region [0x62b000000200,0x62b000006d80)\nallocated by thread T2 here:\n    #0 0x52b29d  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x52b29d)\n    #1 0x2636186  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x2636186)\n    #2 0x269c9f7  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x269c9f7)\n    #3 0x2ee2636  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x2ee2636)\n    #4 0x272a7ed  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x272a7ed)\n    #5 0x27189b7  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x27189b7)\n    #6 0x271a5fa  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x271a5fa)\n    #7 0x2dfc541  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x2dfc541)\n    #8 0x2cb7a29  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x2cb7a29)\n    #9 0x2cc1134  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x2cc1134)\n    #10 0x3215564  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x3215564)\n    #11 0x32177a3  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x32177a3)\n    #12 0x7fe20d8ae608  (/lib/x86_64-linux-gnu/libpthread.so.0+0x9608)\n\nThread T2 created by T0 here:\n    #0 0x51499c  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x51499c)\n    #1 0x3215c9d  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x3215c9d)\n    #2 0x32143b8  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x32143b8)\n    #3 0x7b8337  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x7b8337)\n    #4 0x7ba88b  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x7ba88b)\n    #5 0x58423e  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x58423e)\n    #6 0x869f08  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x869f08)\n    #7 0x593e97  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x593e97)\n    #8 0x596bd9  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x596bd9)\n    #9 0x596f94  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x596f94)\n    #10 0x577101  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x577101)\n    #11 0x56464e  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x56464e)\n    #12 0x45c0d3  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x45c0d3)\n    #13 0x4479e2  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x4479e2)\n    #14 0x44d4aa  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x44d4aa)\n    #15 0x4763d2  (/clusterfuzz/run_bot/clusterfuzz/bot/builds/libvips_libfuzzer_asan/custom/pngsave_buffer_fuzzer+0x4763d2)\n    #16 0x7fe20d6ae0b2  (/lib/x86_64-linux-gnu/libc.so.6+0x270b2)\n", "crash_state": "jxl::ModularFrameDecoder::DecodeGroup\njxl::FrameDecoder::ProcessACGroup\njxl::ThreadPool::RunCallState<jxl::FrameDecoder::ProcessSections\n", "crash_type": "Heap-buffer-overflow\nREAD {*}", "disable_ubsan": false, "duplicate_of": null, "fixed": "", "flaky_stack": false, "fuzzed_keys": "6c218fe5-1c37-4271-9685-5e2723013665", "fuzzer_name": "libFuzzer", "fuzzer_name_indices": ["libFuzzer_pngsave_buffer_fuzzer", "libFuzzer"], "gestures": [], "group_bug_information": 0, "group_id": 0, "has_bug_flag": false, "http_flag": false, "impact_beta_version": null, "impact_beta_version_indices": [], "impact_beta_version_likely": false, "impact_extended_stable_version": null, "impact_extended_stable_version_indices": [], "impact_extended_stable_version_likely": false, "impact_head_version": null, "impact_head_version_indices": [], "impact_head_version_likely": null, "impact_indices": [], "impact_stable_version": null, "impact_stable_version_indices": [], "impact_stable_version_likely": false, "impact_version_indices": [], "is_a_duplicate_flag": false, "is_impact_set_flag": false, "is_leader": true, "job_type": "libvips_libfuzzer_asan", "keywords": ["libfuzzer_pngsave", "modularframedecoder::decode", "callstate", "fuzzer_pngsave_buffer_fuzzer", "jxl::modular", "runcallstate<jxl", "asan", "acgroup", "pool::runcallstate<jxl::framedecoder::process", "callstate<jxl::framedecoder::processsections", "framedecoder::decodegroup", "pool::runcallstate<jxl::framedecoder::processsections", "state<jxl::framedecoder", "state", "jxl::threadpool::runcallstate<jxl::framedecoder", "pngsave", "decodegroup", "framedecoder::processsections", "jxl::framedecoder", "runcallstate<jxl::framedecoder::processsections", "pool::runcallstate<jxl", "buffer_fuzzer", "jxl::threadpool::runcallstate<jxl::frame", "callstate<jxl::framedecoder::process", "pool::runcallstate<jxl::framedecoder", "jxl::threadpool::runcall", "decode", "pool::runcallstate", "decoder::processacgroup", "fuzzer_pngsave_buffer", "libfuzzer_asan", "framedecoder::processacgroup", "processacgroup", "buffer", "pngsave_buffer", "fuzzer", "modularframedecoder::decodegroup", "frame", "runcallstate", "framedecoder::processac", "threadpool::runcallstate<jxl::frame", "runcallstate<jxl::framedecoder::process", "heap-buffer-overflow", "decoder::decodegroup", "runcall", "ac", "heap-buffer", "jxl::modularframedecoder::decodegroup", "fuzzer_pngsave", "callstate<jxl::framedecoder", "process", "buffer-overflow", "jxl::modularframe", "decoder::processac", "jxl::threadpool::runcallstate<jxl", "framedecoder", "jxl::frame", "processsections", "jxl::modularframedecoder", "decoder", "framedecoder::process", "decoder::process", "threadpool::runcallstate", "read {*}", "libvips_libfuzzer", "overflow", "pool::runcallstate<jxl::frame", "thread", "jxl::thread", "threadpool::runcallstate<jxl::framedecoder::processsections", "modularframe", "run", "state<jxl::frame", "libfuzzer_pngsave_buffer_fuzzer", "pngsave_buffer_fuzzer", "pool::run", "group", "heap", "callstate<jxl", "libfuzzer_pngsave_buffer", "sections", "threadpool::runcall", "read", "processac", "modular", "pool", "callstate<jxl::frame", "threadpool::runcallstate<jxl::framedecoder::process", "linux", "jxl::framedecoder::processac", "runcallstate<jxl::frame", "jxl::modularframedecoder::decode", "state<jxl::framedecoder::process", "call", "decoder::processsections", "libvips_libfuzzer_asan", "jxl::framedecoder::process", "decoder::decode", "jxl::threadpool::runcallstate<jxl::framedecoder::processsections", "jxl::framedecoder::processsections", "jxl", "lib", "modularframedecoder", "threadpool::run", "runcallstate<jxl::framedecoder", "jxl::framedecoder::processacgroup", "jxl::threadpool::runcallstate", "pool::runcall", "threadpool::runcallstate<jxl", "libfuzzer", "framedecoder::decode", "threadpool", "threadpool::runcallstate<jxl::framedecoder", "state<jxl::framedecoder::processsections", "jxl::threadpool::run", "jxl::threadpool", "state<jxl", "jxl::threadpool::runcallstate<jxl::framedecoder::process", "libvips"], "last_tested_crash_stacktrace": null, "minidump_keys": "", "minimized_arguments": "-rss_limit_mb=2560 -timeout=60", "minimized_keys": "1f76b285-401e-428d-b76b-1a6ae75ccc01", "one_time_crasher_flag": false, "open": true, "overridden_fuzzer_name": "libFuzzer_pngsave_buffer_fuzzer", "platform": "linux", "platform_id": "linux", "project_name": "test-project", "queue": "jobs-linux", "redzone": 64, "regression": "NA", "security_flag": true, "security_severity": 2, "status": "Processed", "symbolized": false, "timeout_multiplier": 1.0, "timestamp": 1638455571, "triaged": false, "uploader_email": null, "window_argument": "", "id": 95005}, "timestamp": 1638455571.446845, "show_blame": false, "show_impact": false, "impacts_production": false, "find_similar_issues_options": [{"type": "open", "label": "Open"}, {"type": "all", "label": "All"}], "auto_delete_timestamp": null, "auto_close_timestamp": null, "memory_tool_display_label": "Sanitizer", "memory_tool_display_value": "address (ASAN)", "last_tested": "1:1 (No component revisions found!)", "is_admin_or_not_oss_fuzz": true, "has_issue_tracker": false, "reproduction_help_url": "", "is_local_development": true, "fuzzer_display": {"engine": "libFuzzer", "target": "pngsave_buffer_fuzzer", "name": "libFuzzer", "fully_qualified_name": "libFuzzer_pngsave_buffer_fuzzer"}}